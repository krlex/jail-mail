---
- name: install packages
  become: yes
  with_items: "{{ jabber_packages }}"
  apt:
    pkg: "{{ item.name }}"
    state: latest
  notify:
    - restart ejabberd

- name: configure settings
  become: yes
  template:
    src: ejabberd.yml.j2
    dest: /etc/ejabberd/ejabberd.yml
    owner: ejabberd
    group: ejabberd
  notify:
    - restart ejabberd
